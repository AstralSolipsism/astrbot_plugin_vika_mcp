# 智能维格表 MCP 插件 (astrbot-plugin-vika-mcp)

## 📖 项目简介

本插件是为 [AstrBot](https://github.com/AstrBotDevs/AstrBot) 设计的、基于 MCP 架构的维格表智能化集成方案。它将维格表的强大能力与大语言模型的自然语言理解能力相结合，让您能够通过**一句话**与您的数据进行交互，轻松实现对数据的查询、添加和修改，而无需关心复杂的数据表 ID 或 API 调用细节。

维格表（Vika）是一款在线智能多维表格，它不仅仅是传统电子表格的升级，更是一个灵活的数据库和项目管理工具，能够帮助团队轻松搭建各类业务系统，在多个企业中被使用。

## ✨ 核心特性

- **自然语言交互**：告别繁琐的 API 请求，直接用日常语言操作数据。例如：“帮我向‘客户表’里添加一条新记录”。
- **智能名称解析**：您可以使用数据表的自然名称（如“库存清单”）或别名进行操作，插件会自动解析为正确的维格表 ID。
- **零配置启动**：在最简配置下，仅需提供您的维格表 API Token，插件即可自动发现并管理您的所有数据表。
- **自动化管理**：自动同步并缓存您空间站中的数据表信息，不仅提升了响应速度，也确保了数据表的实时性。
- **强大的容错性**：当找不到您指定的数据表时，插件会智能推荐最可能的正确名称，提升交互体验。
- **灵活的数据格式**：支持 `JSON` 和键值对（如 `"姓名=张三,年龄=25"`）两种格式的数据输入，满足不同场景的需求。

## ⚙️ 工作原理

本插件基于 MCP 架构，将复杂的维格表操作封装为大语言模型（LLM）易于调用的工具，其工作流程如下：

1.  **用户输入**：您通过自然语言向 AstrBot 发出指令（例如：“帮我查一下项目管理表里有哪些正在进行中的项目？”）。
2.  **LLM 理解与工具选择**：大语言模型分析您的意图，并选择本插件提供的合适工具（如 `query_vika_datasheet`）。
3.  **智能解析与执行**：插件接收到调用后，其核心的**智能名称解析**功能会将“项目管理表”这样的自然名称精准转换为维格表所需的 `dst...` ID，然后执行真正的 API 请求。
4.  **结果格式化**：插件将从维格表获取的结果格式化为对 LLM 友好的 `JSON` 格式。
5.  **生成自然语言回复**：LLM 理解 `JSON` 结果，并生成通顺流畅的自然语言回复给您。

## 🚀 快速开始

1.  从插件市场下载，或者将插件放置于 AstrBot 的 `data/plugins` 目录下。
2.  在插件管理面板中填入最核心的配置项：

    ```yaml
    # 维格表 API Token，你的维格表用户中心 -> API Token
    vika_api_token: "uskxxxxxxxxxxxxxxxx"
    ```
3.  重启 AstrBot，插件即可自动加载并开始工作。

4.  可以通过设置提示词、知识库教会AI怎样使用你的表格，增强使用体验

## 📅 后续优化计划

- **多用户 Token 管理**：未来版本计划支持用户级别的 API Token 配置与关联。这意味着每个用户都可以使用自己的维格表账户进行操作，从而实现更精细的权限控制和个性化的数据管理，满足企业或团队在复杂场景下的协作需求。
